<UserControl x:Class="Presentation.Views.UserManagerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:lc="clr-namespace:Resources.Localization;assembly=Resources"
             xmlns:bh="clr-namespace:Presentation.Behaviors"
             xmlns:sf="http://schemas.syncfusion.com/wpf"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             SnapsToDevicePixels="True">

    <!-- Resources -->
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Resources;component/ModuleResources/UserManagerView.Resources.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

        </ResourceDictionary>
    </UserControl.Resources>

    <!-- Root grid -->
    <Grid>

        <!-- Main grid -->
        <Grid>
            
            <!-- User requests button -->
            <sf:ButtonAdv Style="{StaticResource DefaultRoundedGlyphButtonStyle}"
                          SmallIcon="{StaticResource UserAdd.Black.Line.64}"
                          Margin="{StaticResource Margin12}"
                          Command="{Binding UserRequestsCommand}"
                          VerticalAlignment="Top"
                          HorizontalAlignment="Right" 
                          Panel.ZIndex="10"/>
            
            <!-- Users data grid tool bar manager -->
            <sf:ToolBarManager>
                <sf:ToolBarManager.TopToolBarTray>
                    <sf:ToolBarTrayAdv>
                        <sf:ToolBarAdv Style="{StaticResource DefaultSfToolBarStyle}">
                            <ContentControl ContentTemplate="{StaticResource UsersDataGridToolBarTemplate}">
                                <i:Interaction.Behaviors>
                                    <bh:SfDataGridToolBarBehavior
                                        SfDataGrid="{Binding ElementName=UsersDataGrid}"
                                        GridPrintCommand="{Binding GridPrintCommand}"
                                        RefreshCommand="{Binding RefreshDataGridCommand}"
                                        ExportToExcelCommand="{Binding ExportToExcelCommand}"
                                        ExportToPdfCommand="{Binding ExportToPdfCommand}"/>
                                </i:Interaction.Behaviors>
                            </ContentControl>
                        </sf:ToolBarAdv>
                    </sf:ToolBarTrayAdv>
                </sf:ToolBarManager.TopToolBarTray>
                <sf:ToolBarManager.Content>
                    
                    <!-- Users data grid -->
                    <sf:SfDataGrid x:Name="UsersDataGrid"
                                   ItemsSource="{Binding Users}"
                                   AllowGrouping="True"
                                   AllowFiltering="True"
                                   ShowGroupDropArea="True"
                                   AutoGenerateColumns="False"
                                   EnableDataVirtualization="True"
                                   ScrollMode="Async"
                                   ShowBusyIndicator="True">
                        
                        <sf:SfDataGrid.Columns>
                            <sf:GridTextColumn MappingName="FirstName" HeaderText="{x:Static lc:Strings.FirstName}"/>
                            <sf:GridTextColumn MappingName="LastName" HeaderText="{x:Static lc:Strings.LastName}"/>
                            <sf:GridTextColumn MappingName="Login" HeaderText="{x:Static lc:Strings.Username}"/>
                        </sf:SfDataGrid.Columns>
                        
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Loaded">
                                <i:InvokeCommandAction Command="{Binding UsersDataGridLoadedCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        
                        <i:Interaction.Behaviors>
                            <bh:SfDataGridPrintBehavior GridPrintCommand="{Binding GridPrintCommand}"
                                                        GridPrintParameters="{Binding GridPrintParameters}"/>
                        </i:Interaction.Behaviors>
                        
                    </sf:SfDataGrid>
                    
                </sf:ToolBarManager.Content>
            </sf:ToolBarManager>
            
        </Grid>

        <!-- Overlay content control -->
        <ContentControl Content="{Binding OverlayContent}"
                        Visibility="{Binding IsOverlayOpen, Converter={StaticResource BooleanToVisibilityConverter}}" />

        <!-- Dialog content control -->
        <ContentControl Grid.Row="0"
                        Content="{Binding DialogContent}"
                        Visibility="{Binding IsDialogOpen, Converter={StaticResource BooleanToVisibilityConverter}}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Panel.ZIndex="5" />

    </Grid>
</UserControl>